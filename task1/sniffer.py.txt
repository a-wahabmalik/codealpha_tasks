from scapy.all import sniff, IP, TCP, UDP, ICMP

def show_packet(packet):
    if IP in packet:
        src = packet[IP].src
        dst = packet[IP].dst
        if TCP in packet:
            proto = "TCP"
        elif UDP in packet:
            proto = "UDP"
        elif ICMP in packet:
            proto = "ICMP"
        else:
            proto = "Other"
        print(f"Source: {src} --> Destination: {dst} | Protocol: {proto}")

sniff(prn=show_packet, count=10)
